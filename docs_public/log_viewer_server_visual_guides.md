# 로그 뷰어 서버 모드 시각화 가이드

이 문서는 `log_viewer_server` 화면에 표시되는 주요 시각화와 지표를 팀원들이 빠르게 이해할 수 있도록 정리한 자료입니다. 각 항목의 의미, 해석 방법, 활용 팁을 함께 제공합니다.

---

## 1. 상단 카드형 요약 (뉴스 클릭, 챗 질문, RAG 답변)
- **표시 내용**: 현재 필터(사용자, 기간, 이벤트 타입, 세션 간격)에 맞춰 집계된 핵심 이벤트 수.
- **해석**: 특정 기간 동안 어떤 기능이 주로 사용되었는지 파악하는 1차 지표입니다. 예를 들어 `뉴스 클릭` 대비 `챗 질문`이 급감했다면 챗봇 진입 흐름이 막혔는지 확인이 필요합니다.
- **활용 팁**: 필터를 바꿔가며 시간대나 사용자 그룹별 변화를 비교하면 전환 흐름 개선 포인트를 찾을 수 있습니다.

## 2. 전환 퍼널 표 (뉴스 클릭 → 상세 열람 → 챗 질문 → RAG 답변)
- **표시 내용**: 첫 클릭 이후 단계별 잔존율을 계산한 테이블과 전환율.
- **해석**: 뉴스 상세 열람이나 챗 질문 단계에서 전환율이 급락한다면 UX 개선이나 콘텐츠 보강이 필요합니다.
- **활용 팁**: 필터를 통해 특정 사용자군, 시간대, 이벤트 타입에서의 퍼널 변화를 비교하면 전환 병목 구간을 진단할 수 있습니다.

## 3. 이벤트 로그 테이블
- **표시 내용**: 최신 이벤트를 시간순으로 보여주며, 주요 컬럼(`event_time`, `event_name`, `user_id`, `session_id`, `surface`, `source`, `ref_id`)을 정리합니다.
- **해석**: 이상 징후나 특정 사용자의 상세 활동을 트레이싱하는데 사용합니다.
- **활용 팁**: 기간/사용자 필터를 조합하여 특정 이슈 상황의 이벤트 흐름을 재현할 수 있습니다.

## 4. 이벤트 타입별 통계
- **표시 내용**: 이벤트 타입별 발생 건수 테이블과 Plotly 파이 차트(설치된 경우).
- **해석**: 어떤 기능이 가장 자주 호출되는지, 비정상적으로 치우친 이벤트가 없는지 확인합니다.
- **활용 팁**: 파이 차트는 상위 15개 이벤트만 포함되므로 장기 추세를 보려면 CSV 다운로드 후 추가 분석을 권장합니다.

## 5. 세션 분석 (MVP)
### 5-1. 세션 요약 테이블
- **표시 내용**: 추산된 `session_id_resolved`별 사용자, 첫/마지막 이벤트 시각, 이벤트 수, 이벤트 종류 수, 세션 지속시간(분)을 나열합니다.
- **해석**: 체류 시간이 긴 세션, 이벤트가 폭발적으로 많이 발생한 세션을 식별합니다.
- **활용 팁**: 상단 슬라이더 “세션 간 최대 허용 공백(분)”을 조정하며 세션 경계 정의가 지표에 미치는 영향을 점검하세요.

### 5-2. 세션 지속시간 분포 (막대 + 누적 비율 라인)
- **표시 내용**: 지속시간 구간별 세션 수를 막대로, 누적 비율을 라인으로 시각화합니다.
- **해석**: 다수의 세션이 어느 구간에 몰려 있는지, 전체의 X%가 어떤 시간까지 누적되는지를 직관적으로 파악할 수 있습니다.
- **활용 팁**: 누적 비율 라인의 급격한 상승 지점은 “대부분의 사용자가 이 정도 시간 안에 이탈한다”는 의미이므로 UX 보완 지점을 찾는 데 활용합니다.

### 5-3. 세션당 이벤트 수 Top 15
- **표시 내용**: 이벤트 수가 많은 상위 세션을 막대 그래프로 표시합니다.
- **해석**: 특정 세션에서 유난히 많은 이벤트가 발생했다면 집중 사용 혹은 오류 루프를 의심해볼 수 있습니다.
- **활용 팁**: 해당 세션 ID를 검색해 이벤트 로그를 확인하면 실제 사용 흐름을 재현할 수 있습니다.

## 6. 용어 클릭/응답 통계
- **표시 내용**: `glossary_click`, `glossary_answer` 이벤트를 추려 용어별 집계, 상위 15개 용어 바 차트(Plotly 설치 시), 기본 `st.bar_chart`를 제공합니다.
- **해석**: 어떤 금융 용어에 관심이 집중되는지 확인할 수 있습니다.
- **활용 팁**: 용어별 총합뿐 아니라 클릭과 답변의 비율을 비교하면 용어 설명 품질을 평가할 수 있습니다.

---

### 세션 간격 슬라이더 활용법
- **위치**: Supabase 모드 및 API 모드 필터 영역.
- **기능**: `event_time` 간격이 지정한 분(minute) 이상이면 새로운 세션으로 간주해 `session_id_resolved`를 재계산합니다.
- **권장 사용**: 기본값 30분, 빠르게 끊어지는 서비스라면 10~15분, 데스크탑 환경의 장기 세션이라면 60분 이상 권장.
- **영향 범위**: 세션 요약·지속시간 그래프·세션별 이벤트 Top 차트와 퍼널 계산에 모두 영향을 줍니다.

---

### 분석 시 유의사항
1. **필터 영향 확인**: 사용자, 기간, 이벤트 타입 필터에 따라 모든 지표가 달라지므로, 비교 분석 시 동일 조건을 유지해야 합니다.
2. **Plotly 설치 여부**: Plotly가 설치되지 않은 환경에서는 기본 Streamlit 차트로 대체됩니다(시각 깊이가 낮아질 수 있음).
3. **데이터 스냅샷**: 다수의 차트가 상위 일부만 보여주므로, 상세 분석이 필요하면 CSV 다운로드 후 외부 도구에서 추가 분석하세요.
4. **세션 추산 특성**: 실제 백엔드 세션 ID가 없는 데이터에 대해서만 시간 간격 기반 추산을 사용합니다. 이미 세션 ID가 있는 경우에는 기존 값이 유지됩니다.

이 문서는 추후 그래프 변경이나 새로운 시각화가 추가될 때 업데이트가 필요합니다. 팀원들이 분석할 때 “각 시각화가 무엇을 보여주고, 어떻게 활용할 수 있는지” 빠르게 파악할 수 있도록 유지관리해 주세요.

