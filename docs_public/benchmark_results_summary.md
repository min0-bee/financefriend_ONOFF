# Persona 응답 생성 성능 벤치마크 결과 요약

**실험 일자**: 2025년  
**실험 질문**: "인플레이션이 뭐야?"  
**실행 횟수**: 10회  
**비교 대상**: 원본 버전 vs 최적화 버전

---

## 📊 실행 결과 요약

### 전체 응답 시간 비교

| 항목 | 원본 버전 | 최적화 버전 | 개선율 |
|------|----------|------------|--------|
| **평균 응답 시간** | 4.616초 | 3.178초 | **+31.1% 빠름** ⚡ |
| 최소 시간 | 3.943초 | 2.690초 | - |
| 최대 시간 | 6.153초 | 3.607초 | - |
| 표준편차 | 0.740초 | 0.276초 | **62.7% 감소** (더 안정적) |

**결론**: 최적화 버전이 **평균 1.4초 더 빠르고**, 응답 시간의 변동성도 크게 줄어들었습니다.

---

## 🔍 단계별 시간 분석

### 원본 버전

| 단계 | 평균 시간 | 비율 |
|------|----------|------|
| 프롬프트 빌드 | 0.00004초 | 0.001% |
| **API 호출** | **4.616초** | **99.99%** |
| 응답 파싱 | 0.00001초 | 0.0002% |
| 출력 포맷팅 | 0.00001초 | 0.0002% |
| **총 시간** | **4.616초** | **100%** |

### 최적화 버전

| 단계 | 평균 시간 | 비율 |
|------|----------|------|
| 프롬프트 빌드 | 0.00003초 | 0.001% |
| 토큰 추정 | 0.000005초 | 0.0002% |
| 로깅 오버헤드 | 0.0000007초 | 0.00002% |
| **API 호출** | **3.178초** | **99.99%** |
| 응답 파싱 | 0.00002초 | 0.0006% |
| 출력 포맷팅 | 0.00001초 | 0.0003% |
| **총 시간** | **3.178초** | **100%** |

**핵심 발견**: 
- API 호출 시간이 전체 시간의 99.99%를 차지합니다.
- 최적화 버전의 추가 단계(토큰 추정, 로깅)는 미미한 오버헤드만 발생합니다.
- 최적화 버전의 API 호출이 31.1% 더 빠릅니다.

---

## 📨 메시지 구조 비교

| 항목 | 원본 버전 | 최적화 버전 | 차이 |
|------|----------|------------|------|
| 메시지 수 | 3개 | 7개 | +4개 (Few-shot 추가) |
| 입력 토큰 | 측정 안 됨 | 581개 | - |
| 출력 토큰 | 측정 안 됨 | 평균 124개 (113~142) | - |

**분석**: 
- 최적화 버전은 Few-shot 예제 4개를 추가하여 메시지 수가 증가했습니다.
- 하지만 `max_tokens=400`으로 제한하여 출력 토큰이 줄어들어 전체 응답 시간은 단축되었습니다.

---

## 💬 실제 질의와 답변 예시

### 질문
> 인플레이션이 뭐야?

---

### 원본 버전 응답

```
방금 본 뉴스 주제야. '인플레이션이 뭐야?' 궁금했지? 간단히 정리해줄게!

📘 정의: 인플레이션은 물가 상승이야.

💡 영향: 식료품 가격이 올라서 장보기 비용이 증가해. 월급이 그대로면 실질 구매력이 줄어들어.

🌟 비유: 마트에서 장을 볼 때 가격이 매번 오르는 것처럼 느껴져. 그래서 같은 돈으로 사는 양이 줄어들어서 더 많은 돈이 필요해.

더 궁금한 거 있으면 편하게 물어봐!
```

**응답 시간**: 약 5.3초 (샘플 실행) | 평균 4.6초 (10회 실행)

---

### 최적화 버전 응답

```
방금 본 뉴스 주제야. '인플레이션이 뭐야?' 궁금했지? 간단히 정리해줄게!

📘 정의: 인플레이션은 물가 상승이야.

💡 영향: 같은 돈으로 살 수 있는 게 줄어들어. 생활비가 더 많이 드는 느낌이야.

🌟 비유: 바다의 수위처럼 물가가 올라. 수영하기 힘들어지는 것과 같아.

더 궁금한 거 있으면 편하게 물어봐!
```

**응답 시간**: 약 3.6초 (샘플 실행) | 평균 3.2초 (10회 실행)  
**API 지연**: 약 3.3초 (샘플) | 평균 2.7~3.3초 (10회 실행)  
**입력 토큰**: 567개 (샘플) | 평균 581개 (10회 실행)  
**출력 토큰**: 125개 (샘플) | 평균 124개 (113~142개, 10회 실행)

---

## 📈 10회 실행 상세 데이터

### 원본 버전 실행 시간 (초)

| 실행 | 총 시간 | API 호출 | 프롬프트 빌드 | 파싱 | 포맷팅 |
|------|---------|---------|-------------|------|--------|
| 1 | 5.234 | 5.234 | 0.00005 | 0.00003 | 0.00002 |
| 2 | 3.945 | 3.945 | 0.00002 | 0.00001 | 0.00002 |
| 3 | 3.943 | 3.943 | 0.00002 | 0.00002 | 0.00001 |
| 4 | 6.153 | 6.153 | 0.00011 | 0.00001 | 0.00001 |
| 5 | 3.988 | 3.988 | 0.00002 | 0.00001 | 0.00001 |
| 6 | 4.136 | 4.136 | 0.00008 | 0.00001 | 0.00002 |
| 7 | 4.624 | 4.624 | 0.00002 | 0.00001 | 0.00001 |
| 8 | 5.253 | 5.253 | 0.00003 | 0.00001 | 0.00001 |
| 9 | 4.742 | 4.742 | 0.00002 | 0.00001 | 0.00001 |
| 10 | 4.138 | 4.138 | 0.00002 | 0.00001 | 0.00001 |

**평균**: 4.616초 | **최소**: 3.943초 | **최대**: 6.153초 | **표준편차**: 0.740초

### 최적화 버전 실행 시간 (초)

| 실행 | 총 시간 | API 호출 | 토큰 추정 | 로깅 | 파싱 | 포맷팅 | 출력 토큰 |
|------|---------|---------|----------|------|------|--------|----------|
| 1 | 3.019 | 3.019 | 0.000004 | 0.0000005 | 0.00001 | 0.00001 | 115 |
| 2 | 3.323 | 3.323 | 0.000010 | 0.0000009 | 0.00001 | 0.00001 | 122 |
| 3 | 3.607 | 3.607 | 0.000005 | 0.0000003 | 0.00006 | 0.00004 | 139 |
| 4 | 2.953 | 2.953 | 0.000004 | 0.0000003 | 0.00001 | 0.00001 | 118 |
| 5 | 3.336 | 3.336 | 0.000005 | 0.0000004 | 0.00004 | 0.00004 | 113 |
| 6 | 3.476 | 3.476 | 0.000007 | 0.000001 | 0.00001 | 0.00001 | 130 |
| 7 | 3.255 | 3.255 | 0.000009 | 0.000002 | 0.00001 | 0.00001 | 142 |
| 8 | 3.153 | 3.153 | 0.000003 | 0.0000004 | 0.00001 | 0.00001 | 125 |
| 9 | 2.969 | 2.969 | 0.000004 | 0.0000003 | 0.00001 | 0.00001 | 114 |
| 10 | 2.690 | 2.690 | 0.000004 | 0.0000004 | 0.00001 | 0.00001 | 118 |

**평균**: 3.178초 | **최소**: 2.690초 | **최대**: 3.607초 | **표준편차**: 0.276초  
**평균 출력 토큰**: 123.6개 (113~142개)

---

## 🎯 주요 발견 사항

### 1. 성능 개선
- ✅ **31.1% 더 빠른 응답 시간** (4.616초 → 3.178초)
- ✅ **62.7% 더 안정적인 응답 시간** (표준편차 0.740초 → 0.276초)
- ✅ 최대 응답 시간도 크게 단축 (6.153초 → 3.607초)

### 2. 최적화 효과 분석
- **Few-shot 추가**: 메시지 수 3개 → 7개로 증가했지만, 전체 시간은 단축
- **max_tokens 제한**: 700 → 400으로 줄여 출력 토큰 감소 → 생성 시간 단축
- **추가 오버헤드**: 토큰 추정과 로깅은 미미한 영향만 발생 (~0.00001초)

### 3. 병목 지점
- **API 호출이 전체 시간의 99.99% 차지**
- 프롬프트 빌드, 파싱, 포맷팅은 거의 시간 소모 없음
- 네트워크 지연과 모델 처리 시간이 주요 요인

---

## 💡 결론 및 권장 사항

### 결론
최적화 버전이 **명확하게 더 빠르고 안정적**입니다. 주요 개선 요인은 `max_tokens=400`으로 출력 길이를 제한하여 생성 시간을 단축한 것입니다.

### 권장 사항
1. ✅ **최적화 버전 채택**: 31.1% 성능 개선과 안정성 향상
2. ✅ **Few-shot 유지**: 메시지 수는 증가했지만 응답 품질 향상에 도움
3. ✅ **max_tokens 조정**: 필요에 따라 300~500 사이에서 조정 가능
4. ⚠️ **추가 최적화**: API 호출 시간이 병목이므로 네트워크 최적화나 캐싱 고려

---

## 📎 참고 자료

- 상세 데이터: `results.json`
- 샘플 응답: `sample_responses.json`
- 구조적 문제 분석: `docs_public/structural_issues_analysis.md`
- 최적화 분석: `docs_public/optimization_analysis.md`

---

**문서 작성일**: 2025년  
**작성자**: 성능 분석 팀

