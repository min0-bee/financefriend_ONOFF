# CSV 기반 문맥 인식 하이라이트 개선

## 개선 내용

### 기존 방식의 문제점
- 하드코딩된 키워드 리스트 사용
- 모든 용어에 동일한 키워드 적용
- 용어별 특성을 반영하지 못함

### 개선된 방식
- **CSV 데이터 활용**: 각 용어의 정의, 비유, 예시에서 키워드 추출
- **용어별 맞춤 키워드**: 각 용어마다 관련 키워드 세트 생성
- **동적 키워드 생성**: CSV 변경 시 자동으로 키워드 업데이트

## 구현 세부사항

### 1. 키워드 추출 함수

```python
def _extract_keywords_from_text(text: str) -> set:
    """
    텍스트에서 경제 관련 키워드 추출
    - 명사 (2-4자 한글)
    - 영문 약어 (2-5자 대문자)
    """
```

### 2. 용어별 키워드 생성

```python
def _build_term_context_keywords() -> Dict[str, set]:
    """
    CSV에서 각 용어별 문맥 키워드를 동적으로 생성
    - 정의에서 키워드 추출
    - 비유에서 키워드 추출
    - 예시에서 키워드 추출 (가장 중요 - 실제 사용 문맥)
    """
```

### 3. 문맥 판단 개선

```python
def is_financial_context(text: str, term: str, ...) -> bool:
    """
    용어별 맞춤 키워드를 사용하여 문맥 판단
    - 각 용어의 특성에 맞는 키워드 사용
    - 더 정확한 문맥 인식
    """
```

## CSV 데이터 활용

### 사용되는 컬럼
1. **금융용어**: 용어명
2. **정의**: 용어 정의에서 키워드 추출
3. **비유**: 비유 문구에서 키워드 추출
4. **예시**: 실제 사용 예시에서 키워드 추출 (가장 중요)

### 예시

**용어: "생산적금융"**
- 정의: "실물경제(기업 투자, 운영자금, 임금 등)에 기여하는 금융 활동"
- 비유: "씨앗에 물을 주는 금융 - 성장의 기반을 만드는 자금"
- 예시: "정부는 자금이 부동산·주식 등 비생산적 부문으로 흘러가지 않도록, 생산적 금융을 확대하겠다고 밝혔다"

**추출된 키워드:**
- 실물경제, 기업, 투자, 운영자금, 임금, 금융, 활동
- 씨앗, 물, 성장, 기반, 자금
- 정부, 자금, 부동산, 주식, 비생산적, 부문, 확대

## 장점

### 1. 정확도 향상
- 용어별 특성 반영
- 실제 사용 문맥 기반 키워드
- CSV 데이터와 완전 연동

### 2. 유지보수성
- CSV만 수정하면 자동 반영
- 하드코딩된 키워드 리스트 불필요
- 구조적이고 확장 가능

### 3. 확장성
- 새로운 용어 추가 시 자동 처리
- 용어별 맞춤 키워드 생성
- 데이터 기반 접근

## 성능

- **캐싱**: 용어별 키워드는 한 번만 생성하고 캐싱
- **처리 시간**: +1-2ms (키워드 조회)
- **메모리**: 용어 수에 비례 (약 1-2MB)

## 사용 예시

```python
# 용어별 키워드 조회
keywords = get_financial_context_keywords("생산적금융")
# {'실물경제', '기업', '투자', '금융', '정부', '부동산', ...}

# 문맥 판단 (자동으로 용어별 키워드 사용)
is_financial = is_financial_context(text, "생산적금융", start, end)
```

## 향후 개선 사항

1. **키워드 가중치**: 예시에서 추출한 키워드에 더 높은 가중치
2. **동의어 처리**: 유의어 컬럼 활용
3. **학습 기반 키워드**: 실제 사용 빈도 기반 키워드 선택

