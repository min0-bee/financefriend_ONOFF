# 오늘 작업 요약 (2025-01-19)

## 🎯 작업 목표
뉴스 기사에서 금융 용어 하이라이트 기능의 정확도 개선 - 브랜드명이나 일반 단어로 사용된 경우 하이라이트되지 않도록 개선

## 🐛 발견한 문제
김치 수출 기사에서 **"대상 종가"**가 하이라이트되는 문제 발견
- "종가"는 브랜드명인데도 금융 용어로 인식됨
- "aT는... 수출국에서..." 같은 문맥에서도 "종가"가 하이라이트됨

## ✅ 해결한 내용

### 1. 문맥 윈도우 크기 축소
- **변경**: 100자 → 50자
- **이유**: 더 빠른 처리, 더 정확한 문맥 판단

### 2. 부정 키워드 목록 추가
브랜드명, 회사명, 일반 단어를 식별하기 위한 목록 추가:
- 브랜드명: `대상`, `종가`, `삼성`, `LG`, `현대`, `기아`, `SK`, `롯데`, `신세계`
- 일반 단어: `김치`, `수출`, `수입`, `제조`, `생산`, `판매`, `마케팅`, `광고`
- 회사 관련: `브랜드`, `회사`, `기업명`, `상표`, `제품명`

### 3. "대상 종가" 패턴 특별 처리
"대상 종가" 또는 "종가 대상" 패턴이 문맥에 있으면 무조건 브랜드명으로 판단

### 4. 부정 키워드 체크 로직 개선
- 부정 키워드 발견 시 → 강한 경제 키워드 확인
- 강한 경제 키워드가 없으면 → 하이라이트 안 함
- 강한 경제 키워드: `코스피`, `코스닥`, `주가`, `장`, `마감`, `거래`, `가격`, `지수`, `시장`, `투자`, `금융`, `경제`, `상승`, `하락`, `변동`, `매매`, `체결`, `호가`

### 5. 단어 경계 고려 매칭
정규식 `\b` (단어 경계)를 사용하여 더 정확한 키워드 매칭

### 6. 일반 단어 제외
"수출", "국가" 같은 일반 단어는 경제 키워드로 인정하지 않음

## 📝 수정한 파일
- `rag/glossary.py`: 문맥 인식 로직 전반 개선

## 🧪 테스트 결과

### ✅ 하이라이트 안 되어야 함 (브랜드명)
- "대상 종가" → 하이라이트 안 됨 ✓
- "aT는... 수출국에서..." → "종가" 하이라이트 안 됨 ✓
- "대상 "종가" 김치는... 국가에 진출" → "종가" 하이라이트 안 됨 ✓

### ✅ 하이라이트 되어야 함 (경제 용어)
- "종가 기준 코스피" → "종가" 하이라이트 됨 ✓
- "오늘 종가가 상승했다" → "종가" 하이라이트 됨 ✓
- "장 마감 시점의 종가" → "종가" 하이라이트 됨 ✓

## 📊 개선 효과
1. **정확도 향상**: 브랜드명으로 사용된 "종가"가 하이라이트되지 않음
2. **처리 속도 개선**: 문맥 윈도우 축소로 더 빠른 처리
3. **오탐지 감소**: 일반 단어가 경제 키워드로 오인식되는 경우 감소

## 📚 참고 문서
- 상세 내용: `docs_public/context_aware_highlighting_improvements_20250119.md`

